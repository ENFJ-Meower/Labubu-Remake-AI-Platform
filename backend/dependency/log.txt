This is a controller of DAG